same_last_n <- same_last_n + 1
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
}
}
}
same_first_total <- 0
same_first_n <- 0
reverse_total <- 0
reverse_n <- 0
same_last_total <- 0
same_last_n <- 0
same_last_total <- 0
same_last_n <- 0
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if((i%%5-1)*5+floor((i-1)/5)+1 == j){
reverse_total <- same_first_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
}
}
}
same_first_total <- 0
same_first_n <- 0
reverse_total <- 0
reverse_n <- 0
same_last_total <- 0
same_last_n <- 0
same_last_total <- 0
same_last_n <- 0
other_total <- 0
other_n <- 0
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if((i%%5-1)*5+floor((i-1)/5)+1 == j){
reverse_total <- same_first_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else {
other_total <- other_total + cor_matrix[i,j]
other_n <- other_n + 1
}
}
}
same_first_mean <- same_first_total / same_first_n
reverse_mean <- reverse_total / reverse_n
same_last_mean <- same_last_total / same_last_n
other_mean <- other_total / other_n
average(coefs$ARAL_ARAL)
mean(coefs$ARAL_ARAL)
same_first_total <- 0
same_first_n <- 0
reverse_total <- 0
reverse_n <- 0
same_last_total <- 0
same_last_n <- 0
same_last_total <- 0
same_last_n <- 0
other_total <- 0
other_n <- 0
rev_corrs_and_coefs <- data.frame()
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if((i%%5-1)*5+floor((i-1)/5)+1 == j){
reverse_total <- same_first_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
rev_corrs_and_coefs <- rbind(rev_corrs_and_coefs,
c(cor_matrix[i,j],
mean(coefs[,i])))
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else {
other_total <- other_total + cor_matrix[i,j]
other_n <- other_n + 1
}
}
}
same_first_mean <- same_first_total / same_first_n
reverse_mean <- reverse_total / reverse_n
same_last_mean <- same_last_total / same_last_n
other_mean <- other_total / other_n
View(rev_corrs_and_coefs)
i <- 1
(i%%5-1)*5+floor((i-1)/5)+1
same_first_total <- 0
same_first_n <- 0
reverse_total <- 0
reverse_n <- 0
same_last_total <- 0
same_last_n <- 0
same_last_total <- 0
same_last_n <- 0
other_total <- 0
other_n <- 0
rev_corrs_and_coefs <- data.frame()
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if((i%%5-1)*5+floor((i-1)/5)+1 == j & i != j){
reverse_total <- same_first_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
rev_corrs_and_coefs <- rbind(rev_corrs_and_coefs,
c(cor_matrix[i,j],
mean(coefs[,i])))
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else {
other_total <- other_total + cor_matrix[i,j]
other_n <- other_n + 1
}
}
}
same_first_mean <- same_first_total / same_first_n
reverse_mean <- reverse_total / reverse_n
same_last_mean <- same_last_total / same_last_n
other_mean <- other_total / other_n
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if((i%%5-1)*5+floor((i-1)/5)+1 == j & i != j){
reverse_total <- same_first_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
rev_corrs_and_coefs <- rbind(rev_corrs_and_coefs,
c(cor_matrix[i,j],
mean(coefs[,i])))
print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else {
other_total <- other_total + cor_matrix[i,j]
other_n <- other_n + 1
}
}
}
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if((i%%5-1)*5+floor((i-1)/5)+1 == j){
reverse_total <- same_first_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
rev_corrs_and_coefs <- rbind(rev_corrs_and_coefs,
c(cor_matrix[i,j],
mean(coefs[,i])))
print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else {
other_total <- other_total + cor_matrix[i,j]
other_n <- other_n + 1
}
}
}
View(coefs)
i = 5
(i%%5-1)*5+floor((i-1)/5)+1
same_first_total <- 0
same_first_n <- 0
reverse_total <- 0
reverse_n <- 0
same_last_total <- 0
same_last_n <- 0
same_last_total <- 0
same_last_n <- 0
other_total <- 0
other_n <- 0
rev_corrs_and_coefs <- data.frame()
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if(((i-1)%%5)*5+floor((i-1)/5)+1 == j){
reverse_total <- same_first_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
rev_corrs_and_coefs <- rbind(rev_corrs_and_coefs,
c(cor_matrix[i,j],
mean(coefs[,i])))
print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else {
other_total <- other_total + cor_matrix[i,j]
other_n <- other_n + 1
}
}
}
same_first_mean <- same_first_total / same_first_n
reverse_mean <- reverse_total / reverse_n
same_last_mean <- same_last_total / same_last_n
other_mean <- other_total / other_n
same_first_total <- 0
same_first_n <- 0
reverse_total <- 0
reverse_n <- 0
same_last_total <- 0
same_last_n <- 0
same_last_total <- 0
same_last_n <- 0
other_total <- 0
other_n <- 0
rev_corrs_and_coefs <- data.frame()
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if(((i-1)%%5)*5+floor((i-1)/5)+1 == j & i != j){
reverse_total <- same_first_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
rev_corrs_and_coefs <- rbind(rev_corrs_and_coefs,
c(cor_matrix[i,j],
mean(coefs[,i])))
print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else {
other_total <- other_total + cor_matrix[i,j]
other_n <- other_n + 1
}
}
}
same_first_mean <- same_first_total / same_first_n
reverse_mean <- reverse_total / reverse_n
same_last_mean <- same_last_total / same_last_n
other_mean <- other_total / other_n
View(rev_corrs_and_coefs)
rev_corrs_and_coefs <- data.frame( c("corr" = c(), "coef" = c()))
View(rev_corrs_and_coefs)
rev_corrs_and_coefs <- data.frame( c("corr", "coef"))
View(rev_corrs_and_coefs)
names(rev_corrs_and_coefs) <- c("corr", "coef")
rev_corrs_and_coefs <- data.frame()
names(rev_corrs_and_coefs) <- c("corr", "coef")
rev_corrs_and_coefs <- data.frame(cols = 2)
names(rev_corrs_and_coefs) <- c("corr", "coef")
View(rev_corrs_and_coefs)
same_first_total <- 0
same_first_n <- 0
reverse_total <- 0
reverse_n <- 0
same_last_total <- 0
same_last_n <- 0
same_last_total <- 0
same_last_n <- 0
other_total <- 0
other_n <- 0
rev_corrs_and_coefs <- data.frame()
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if(((i-1)%%5)*5+floor((i-1)/5)+1 == j & i != j){
reverse_total <- same_first_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
rev_corrs_and_coefs <- rbind(rev_corrs_and_coefs,
c(cor_matrix[i,j],
mean(coefs[,i])))
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else {
other_total <- other_total + cor_matrix[i,j]
other_n <- other_n + 1
}
}
}
same_first_mean <- same_first_total / same_first_n
reverse_mean <- reverse_total / reverse_n
same_last_mean <- same_last_total / same_last_n
other_mean <- other_total / other_n
names(rev_corrs_and_coefs) <- c("corr", "coef")
View(coefs)
View(rev_corrs_and_coefs)
ggplot(rev_corrs_and_coefs, aes(x=corr, y=coef)) +
geom_point()
sum(rev_corrs_and_coefs$corr)
same_first_total <- 0
same_first_n <- 0
reverse_total <- 0
reverse_n <- 0
same_last_total <- 0
same_last_n <- 0
same_last_total <- 0
same_last_n <- 0
other_total <- 0
other_n <- 0
rev_corrs_and_coefs <- data.frame()
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if(((i-1)%%5)*5+floor((i-1)/5)+1 == j & i != j){
reverse_total <- reverse_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
rev_corrs_and_coefs <- rbind(rev_corrs_and_coefs,
c(cor_matrix[i,j],
mean(coefs[,i])))
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else {
other_total <- other_total + cor_matrix[i,j]
other_n <- other_n + 1
}
}
}
same_first_mean <- same_first_total / same_first_n
reverse_mean <- reverse_total / reverse_n
same_last_mean <- same_last_total / same_last_n
other_mean <- other_total / other_n
View(rev_corrs_and_coefs)
View(cor_matrix)
View(rev_corrs_and_coefs)
coefs_long <- gather(coefs_mavg %>% select("AVIA_ESSO", "ESSO_AVIA", "date"), key="variable", value="value", -date)
coefs_mavg <- coefs
cols_to_average <- setdiff(names(coefs), "date")
coefs_mavg[cols_to_average] <- lapply(coefs[cols_to_average], function(x) rollmean(x, k=14, fill=NA, align="right"))
library(dplyr)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(osrm)
library(lfe)
library(sandwich)
library(lmtest)
library(corrplot)
coefs_mavg[cols_to_average] <- lapply(coefs[cols_to_average], function(x) rollmean(x, k=14, fill=NA, align="right"))
coefs_long <- gather(coefs_mavg %>% select("AVIA_ESSO", "ESSO_AVIA", "date"), key="variable", value="value", -date)
ggplot(data=coefs_long, aes(x=date, y=value, color=variable)) +
geom_line() +
labs(title="Line Graph Over Time", x="Date", y="Value") +
theme_minimal()
oil <- read.csv("Europe_Brent_Spot_Price_FOB.csv", skip = 4) %>%
mutate(Day = as.Date(Day, format="%m/%d/%Y"))
View(oil)
coefs_diff <- coefs[2:nrow(coefs),1:25] - coefs[1:(nrow(coefs)-1),1:25]
coefs_diff <-( coefs[2:nrow(coefs),1:25] - coefs[1:(nrow(coefs)-1),1:25] ) %>%
cbind(coefs$date[2:nrow(coefs)])
View(coefs_diff)
model <- lm(ARAL_TOTAL ~ TOTAL_ARAL, data = coefs_diff)
summary(model)
model <- lm(ARAL_TOTAL ~ TOTAL_ARAL + lag(TOTAL_ARAL), data = coefs_diff)
summary(model)
model <- lm(TOTAL_ARAL ~ ARAL_TOTAL + lag(ARAL_TOTAL), data = coefs_diff)
summary(model)
model <- lm(TOTAL_ARAL ~ ARAL_TOTAL, data = coefs_diff)
summary(model)
model <- lm(ARAL_TOTAL ~ TOTAL_ARAL, data = coefs_diff)
summary(model)
model <- lm(TOTAL_ARAL ~ ARAL_TOTAL, data = coefs_diff)
summary(model)
model <- lm(ARAL_TOTAL ~ lag(TOTAL_ARAL), data = coefs_diff)
summary(model)
model <- lm(ARAL_TOTAL ~ lag(ARAL_TOTAL), data = coefs_diff)
summary(model)
model <- lm(TOTAL_ARAL ~ lag(TOTAL_ARAL), data = coefs_diff)
summary(model)
View(coefs)
model <- lm(ARAL_AVIA ~ AVIA_ARAL, data = coefs_diff)
summary(model)
model <- lm(AVIA_ARAL ~ ARAL_AVIA, data = coefs_diff)
summary(model)
model <- lm(ARAL_AVIA ~ TOTAL_Shell, data = coefs_diff)
summary(model)
model <- lm(TOTAL_AVIA ~ TOTAL_Shell, data = coefs_diff)
summary(model)
model <- lm(coefs_diff[,1] ~ coefs_diff[,2], data = coefs_diff)
summary(model)
model$
summary(model)$coefficients[, "Pr(>|t|)"]
model <- lm(coefs_diff[,1] ~ coefs_diff[,2])
model$
summary(model)$coefficients[, "Pr(>|t|)"]
model_summary <- summary(model)
model_summary$coefficients[, "Pr(>|t|)"]
model_summary$coefficients[, "Pr(>|t|)"][2,2]
model_summary$coefficients[, "Pr(>|t|)"][2]
model_summary$coefficients[, "Pr(>|t|)"][2][[1]]
same_first_total <- 0
same_first_n <- 0
reverse_total <- 0
reverse_n <- 0
same_last_total <- 0
same_last_n <- 0
same_last_total <- 0
same_last_n <- 0
other_total <- 0
other_n <- 0
rev_corrs_and_coefs <- data.frame()
p_vals <- data.frame()
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if(((i-1)%%5)*5+floor((i-1)/5)+1 == j & i != j){
reverse_total <- reverse_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
rev_corrs_and_coefs <- rbind(rev_corrs_and_coefs,
c(cor_matrix[i,j],
mean(coefs[,i])))
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else {
other_total <- other_total + cor_matrix[i,j]
other_n <- other_n + 1
}
if (i != j){
model_summary <- lm(coefs_diff[,i] ~ coefs_diff[,j]) %>% summary()
p_vals[i,j] <- model_summary$coefficients[, "Pr(>|t|)"][2][[1]]
}
}
}
same_first_total <- 0
same_first_n <- 0
reverse_total <- 0
reverse_n <- 0
same_last_total <- 0
same_last_n <- 0
same_last_total <- 0
same_last_n <- 0
other_total <- 0
other_n <- 0
rev_corrs_and_coefs <- data.frame()
p_vals <- data.frame()
for (i in 1:nrow(cor_matrix)){
for (j in 1:nrow(cor_matrix)){
if (floor((i-1)/5) == floor((j-1)/5) & i != j){
same_first_total <- same_first_total + cor_matrix[i,j]
same_first_n <- same_first_n + 1
} else if(((i-1)%%5)*5+floor((i-1)/5)+1 == j & i != j){
reverse_total <- reverse_total + cor_matrix[i,j]
reverse_n <- reverse_n + 1
rev_corrs_and_coefs <- rbind(rev_corrs_and_coefs,
c(cor_matrix[i,j],
mean(coefs[,i])))
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else if (i %% 5 == j %% 5 & i != j){
same_last_total <- same_last_total + cor_matrix[i,j]
same_last_n <- same_last_n + 1
#print(paste(colnames(cor_matrix)[i], ", ", colnames(cor_matrix)[j]))
} else {
other_total <- other_total + cor_matrix[i,j]
other_n <- other_n + 1
}
if(i == j){
p_vals[i,j] = 1
}
if (i != j){
model_summary <- lm(coefs_diff[,i] ~ coefs_diff[,j]) %>% summary()
p_vals[i,j] <- model_summary$coefficients[, "Pr(>|t|)"][2][[1]]
}
}
}
View(p_vals)
saveRDS(p_vals, file = "stored_dfs/p_vals.Rdata")
saveRDS(p_vals, file = "stored_dfs/p_vals.csv")
write.csv(p_vals, file = "stored_dfs/p_vals.csv")
write.csv(p_vals, file = "stored_dfs/p_vals.csv")
colMeans(coefs)
colMeans(coefs %>% select(-c(date)))
colMeans(coefs %>% select(-c(date)))
as.matrix(colMeans(coefs %>% select(-c(date))), rows = 5, cols = 5)
as.matrix(colMeans(coefs %>% select(-c(date))), nrow = 5, cols = 5)
as.matrix(colMeans(coefs %>% select(-c(date))), nrow = 5, ncol = 5)
as.matrix(colMeans(coefs %>% select(-c(date))), nrows = 5, ncols = 5)
colMeans(coefs %>% select(-c(date))) %>% write.csv(, file = "stored_dfs/means.csv")
